<!DOCTYPE html>
<html>
<head>
  <title>กำลังดึงตำแหน่ง...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <p id="message">กำลังโหลดตำแหน่งของคุณ กรุณารอสักครู่...</p>

  <script>
    const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSen0WiskZGdwrVbxaomauj_E0KzEcRQll_ItvFxPp54Tk0FIQ/viewform";
    const entryId = "entry.1974648496"; // แก้เฉพาะเลขนี้ถ้าจำเป็น

    navigator.geolocation.getCurrentPosition(function(pos) {
      const lat = pos.coords.latitude.toFixed(6);
      const lng = pos.coords.longitude.toFixed(6);
      const location = `${lat},${lng}`;
      const redirectUrl = `${formUrl}?usp=pp_url&${entryId}=${encodeURIComponent(location)}`;
      window.location.href = redirectUrl;
    }, function(error) {
      let msg = "ไม่สามารถดึงตำแหน่งได้";

      switch(error.code) {
        case error.PERMISSION_DENIED:
          msg = "ผู้ใช้ปฏิเสธการเข้าถึงตำแหน่ง";
          break;
        case error.POSITION_UNAVAILABLE:
          msg = "ข้อมูลตำแหน่งไม่พร้อมใช้งาน";
          break;
        case error.TIMEOUT:
          msg = "หมดเวลาในการดึงตำแหน่ง";
          break;
        default:
          msg = "เกิดข้อผิดพลาดที่ไม่รู้จัก";
      }

      document.getElementById("message").innerText = msg;

      const errorUrl = `${formUrl}?usp=pp_url&${entryId}=${encodeURIComponent(msg)}`;
      window.location.href = errorUrl;
    });
  </script>
</body>
</html>
